{"mappings":"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","sources":["public/js/index.js","public/js/auth.js","public/js/alerts.js","public/js/account.js","public/js/stripe.js"],"sourcesContent":["import '@babel/polyfill';\nimport { login, logout, signup, forgotPassword, resetPassword } from './auth';\nimport { updateData, readImg } from './account';\nimport { bookTour } from './stripe';\n\n// DOM ELEMENTS\nconst loginForm = document.querySelector('.form--login');\nconst signupForm = document.querySelector('.form--signup');\nconst logOutBtn = document.querySelector('.nav__el--logout');\nconst updateDataForm = document.querySelector('.form-user-data');\nconst updateAvaUser = document.querySelector('.form__upload');\nconst updatePasswordForm = document.querySelector('.form-user-password');\nconst forgotPasswordForm = document.querySelector('.form-forgot-password');\nconst resetPasswordForm = document.querySelector('.form-reset-password');\nconst bookBtn = document.getElementById('book-tour');\n\n// DELEGATION\nif (loginForm) {\n  loginForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const email = document.getElementById('email').value;\n    const password = document.getElementById('password').value;\n    login({ email, password });\n  });\n}\n\nif (signupForm) {\n  signupForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const name = document.getElementById('name').value;\n    const email = document.getElementById('email').value;\n    const password = document.getElementById('password').value;\n    const passwordConfirm = document.getElementById('passwordConfirm').value;\n    signup({ name, email, password, passwordConfirm });\n  });\n}\n\nif (logOutBtn) logOutBtn.addEventListener('click', logout);\n\nif (updateDataForm) {\n  updateDataForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const form = new FormData(); // 1 object req.body từ input của form\n    form.append('name', document.getElementById('name').value);\n    form.append('email', document.getElementById('email').value);\n    form.append('photo', document.getElementById('photo').files[0]);\n\n    updateData(form, 'data');\n  });\n}\n\nif (updateAvaUser) {\n  updateAvaUser.addEventListener('change', (e) => {\n    readImg(updateAvaUser, '.form__user-photo');\n  });\n}\n\nif (updatePasswordForm) {\n  updatePasswordForm.addEventListener('submit', async (e) => {\n    e.preventDefault();\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\n\n    const passwordCurrent = document.getElementById('password-current').value;\n    const password = document.getElementById('password').value;\n    const passwordConfirm = document.getElementById('password-confirm').value;\n    await updateData(\n      { passwordCurrent, password, passwordConfirm },\n      'password'\n    );\n\n    document.querySelector('.btn--save-password').textContent = 'Save password';\n    document.getElementById('password-current').value = '';\n    document.getElementById('password').value = '';\n    document.getElementById('password-confirm').value = '';\n  });\n}\n\nif (forgotPasswordForm) {\n  forgotPasswordForm.addEventListener('submit', async (e) => {\n    e.preventDefault();\n    document.querySelector('.btn-forgot-password').textContent = 'Sending...';\n    const email = document.getElementById('email').value;\n    await forgotPassword(email);\n\n    document.querySelector('.btn-forgot-password').textContent = 'Send';\n    document.getElementById('email').value = '';\n  });\n}\n\nif (resetPasswordForm) {\n  resetPasswordForm.addEventListener('submit', (e) => {\n    const resetToken = document.querySelector('h3').innerText;\n    e.preventDefault();\n    const password = document.getElementById('password').value;\n    const passwordConfirm = document.getElementById('passwordConfirm').value;\n    resetPassword({ password, passwordConfirm }, resetToken);\n  });\n}\n\nif (bookBtn) {\n  bookBtn.addEventListener('click', (e) => {\n    e.target.textContent = 'Processing...';\n    const { tourId } = e.target.dataset;\n    bookTour(tourId);\n  });\n}\n","import axios from 'axios'\nimport { showAlert } from './alerts'\n\nexport const login = async (data) => {\n    try {\n        const res = await axios({\n            method: 'POST',\n            url: '/api/v1/users/login',\n            data\n        })\n        if (res.data.status === 'success') {\n            location.assign('/')\n        }\n    } catch (err) {\n        showAlert('error', err.response.data.message)\n    }\n}\n\nexport const signup = async (data) => {\n    try {\n        const res = await axios({\n            method: 'POST',\n            url: '/api/v1/users/signup',\n            data\n        })\n        if (res.data.status === 'success') {\n            showAlert('success', 'Create new account successfully')\n            window.setTimeout(() => {\n                location.assign('/')\n            }, 1000)\n        }\n    } catch (err) {\n        showAlert('error', err.response.data.message)\n    }\n}\n\nexport const logout = async () => {\n    try {\n        const res = await axios({\n            method: 'GET',\n            url: '/api/v1/users/logout',\n        })\n        if (res.data.status === 'success') {\n            location.assign('/')\n        }\n    } catch (err) {\n        showAlert('error', err.response.data.message)\n        window.setTimeout(() => {\n            location.assign('/login')               // chuyển pages sau 2s\n        }, 2000)\n    }\n}\n\nexport const forgotPassword = async (email) => {\n    try {\n        const res = await axios({\n            method: 'POST',\n            url: '/api/v1/users/forgotPassword',\n            data: {\n                email\n            }\n        })\n        if (res.data.status === 'success') {\n            showAlert('success', 'Token sent to email. Check your email')\n        }\n    } catch (err) {\n        showAlert('error', err.response.data.message)\n    }\n}\n\nexport const resetPassword = async (data, resetToken) => {\n    try {\n        const res = await axios({\n            method: 'PATCH',\n            url: `/api/v1/users/resetPassword/${resetToken}`,\n            data\n        })\n        if (res.data.status === 'success') {\n            showAlert('success', 'Your password has changed')\n            window.setTimeout(() => {\n                location.assign('/')\n            }, 2000)\n        }\n    } catch (err) {\n        showAlert('error', err.response.data.message)\n    }\n}\n\n\n","export const hideAlert = () => {\n    const el = document.querySelector('.alert')\n    if (el) el.parentElement.removeChild(el)\n}\n\n// type is success or error \nexport const showAlert = (type, msg, time = 5) => {       // mặc định tắt sau 5s\n    hideAlert()\n    const markup = `<div class=\"alert alert--${type}\">${msg}</div>`\n    document.querySelector('body').insertAdjacentHTML('afterbegin', markup)       // thêm HTML\n    window.setTimeout(hideAlert, time * 1000)\n}","import axios from 'axios'\nimport { showAlert } from './alerts'\n\n// type is either 'data' or 'password'\nexport const updateData = async (data, type) => {\n    try {\n        const url = type === 'password' ? '/api/v1/users/updateMyPassword' : '/api/v1/users/updateMe'\n        const res = await axios({\n            method: 'PATCH',\n            url,\n            data\n        })\n        if (res.data.status === 'success') {\n            showAlert('success', `${type.toUpperCase()} update successfully`)\n            // location.reload(true)                   // reload lại trang\n        }\n    } catch (err) {\n        showAlert('error', err.response.data.message)\n    }\n}\n\nexport const readImg = (input, imgSrc) => {\n    if (input.files && input.files[0]) {\n        const reader = new FileReader()\n        reader.onload = (e) => {\n            document.querySelector(imgSrc).src = e.target.result\n        }\n        reader.readAsDataURL(input.files[0])\n    }\n}\n\n","/* eslint-disable */\nimport axios from 'axios';\nimport { showAlert } from './alerts';\n\nconst stripe = Stripe(\n  'pk_test_51Mx9ijLurg5wn2FXTzsIJsm0tXMPaBMsGKuZyGAxvrfb5CdkXIG5SWZY9iUV070tXOq8oGL7wlynCisKTdVGNFNU00jt8vUUfC'\n);\n\nexport const bookTour = async (tourId) => {\n  try {\n    console.log('session will be received');\n\n    // 1) Get checkout session from API\n    const session = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\n    console.log('session received');\n\n    // 2) Create checkout form + chanre credit card\n    await stripe.redirectToCheckout({\n      sessionId: session.data.session.id,\n    });\n    // await res.redirect(303, session.url);\n  } catch (err) {\n    console.log(err);\n    showAlert('error', err);\n  }\n};\n"],"names":[],"version":3,"file":"bundle.js.map","sourceRoot":"../../"}